<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>موقع من تطوير aljx_67</title>
  <style>
    body {
      font-family: 'Courier New', Courier, monospace;
      text-align: center;
      padding: 20px;
      background-color: #333;
      color: white;
      position: relative;
    }
    #console-output {
      margin-top: 20px;
      font-family: monospace;
      font-size: 14px;
      background-color: black;
      color: white;
      padding: 10px;
      width: 80%;
      height: 300px;
      overflow-y: auto;
      margin: 0 auto;
      border: 2px solid #666;
      border-radius: 5px;
      white-space: pre-wrap;
    }
    #console-input {
      width: 80%;
      font-size: 14px;
      padding: 8px;
      margin-top: 10px;
      border: 2px solid #666;
      border-radius: 5px;
      background-color: #222;
      color: white;
    }
    button {
      font-size: 16px;
      padding: 10px 20px;
      margin: 10px;
      border: 2px solid #444;
      cursor: pointer;
      border-radius: 5px;
    }
    #start-server {
      background-color: green;
      color: white;
    }
    #stop-server {
      background-color: red;
      color: white;
      display: none;
    }
    #restart-server {
      background-color: blue;
      color: white;
      display: none;
    }
    button:hover {
      opacity: 0.8;
    }
    #menu-icon {
      position: absolute;
      top: 10px;
      right: 10px;
      cursor: pointer;
      z-index: 2;
    }
    #menu-icon div {
      width: 30px;
      height: 5px;
      background-color: white;
      margin: 5px 0;
    }
    #side-menu {
      position: fixed;
      top: 0;
      right: -250px;
      width: 250px;
      height: 100%;
      background-color: #444;
      padding-top: 20px;
      transition: 0.3s;
      z-index: 1;
      color: white;
    }
    #side-menu.show {
      right: 0;
    }
    #side-menu a {
      padding: 10px 15px;
      text-decoration: none;
      font-size: 18px;
      color: white;
      display: block;
    }
    #side-menu a:hover {
      background-color: #666;
    }

    /* قسم عرض استخدام الموارد */
    #resource-usage {
      margin-top: 20px;
      font-size: 16px;
      background-color: #222;
      padding: 15px;
      width: 80%;
      margin-left: auto;
      margin-right: auto;
      border-radius: 5px;
      border: 2px solid #666;
      color: #0f0;
      text-align: left;
      font-family: monospace;
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <!-- زر الثلاث خُطوط لفتح القائمة -->
  <div id="menu-icon" onclick="toggleMenu()">
    <div></div><div></div><div></div>
  </div>

  <h1>موقع من تطوير aljx_67</h1>

  <!-- مخرجات الكونسول -->
  <div id="console-output"></div>
  <input type="text" id="console-input" placeholder="Enter command here..." />

  <!-- أزرار التحكم بالسيرفر -->
  <div class="buttons">
    <button id="start-server" onclick="startServer()">Start Server</button>
    <button id="stop-server" onclick="stopServer()">Stop Server</button>
    <button id="restart-server" onclick="restartServer()">Restart Server</button>
  </div>

  <!-- عرض استخدام الرام، المعالج، والتخزين -->
  <div id="resource-usage">
    <h3>حالة استخدام الموارد:</h3>
    <div id="ram-usage">RAM: ...</div>
    <div id="cpu-usage">CPU: ...</div>
    <div id="disk-usage">Disk: ...</div>
  </div>

  <!-- القائمة الجانبية -->
  <div id="side-menu">
    <a href="/editor" target="_blank">تعديل الملفات</a>
    <a href="/add-admin" target="_blank">إضافة مشرف</a>
    <a href="#" onclick="openPlayersList()">قائمة اللاعبين</a>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    // إرسال الأوامر إلى السيرفر عند الضغط Enter
    const consoleInput = document.getElementById('console-input');
    consoleInput.addEventListener('keypress', e => {
      if (e.key === 'Enter') sendCommand();
    });

    function sendCommand() {
      const cmd = consoleInput.value.trim();
      if (!cmd) return;
      socket.emit('send-command', cmd);
      consoleInput.value = '';
    }

    // تحديث الكونسول بمخرجات السيرفر
    socket.on('console-output', data => {
      const out = document.getElementById('console-output');
      out.textContent += data + '\n';
      out.scrollTop = out.scrollHeight;
      saveToLocalStorage(data);
    });

    // تحديث حالة السيرفر
    socket.on('server-status', isRunning => {
      document.getElementById('start-server').style.display = isRunning ? 'none' : 'inline-block';
      document.getElementById('stop-server').style.display = isRunning ? 'inline-block' : 'none';
      document.getElementById('restart-server').style.display = isRunning ? 'inline-block' : 'none';
    });

    // استقبال بيانات الموارد وعرضها
    socket.on('resource-usage', data => {
      document.getElementById('ram-usage').textContent = `RAM: ${data.ram}`;
      document.getElementById('cpu-usage').textContent = `CPU: ${data.cpu}`;
      document.getElementById('disk-usage').textContent = `Disk: ${data.disk}`;
    });

    // وظائف أزرار التحكم
    function startServer() { socket.emit('start-server'); }
    function stopServer() { socket.emit('stop-server'); clearConsole(); }
    function restartServer() { stopServer(); setTimeout(startServer, 3000); }

    // التحكم في القائمة الجانبية
    function toggleMenu() {
      document.getElementById('side-menu').classList.toggle('show');
    }

    // فتح نافذة قائمة اللاعبين
    function openPlayersList() {
      window.open('/players.html', '_blank');
    }

    // حفظ البيانات في localStorage
    function saveToLocalStorage(data) {
      let existing = localStorage.getItem('console-output') || '';
      localStorage.setItem('console-output', existing + data + '\n');
    }

    // تحميل البيانات من localStorage
    function loadFromLocalStorage() {
      const saved = localStorage.getItem('console-output');
      if (saved) {
        const out = document.getElementById('console-output');
        out.textContent = saved;
        out.scrollTop = out.scrollHeight;
      }
    }

    // مسح الكونسول
    function clearConsole() {
      localStorage.removeItem('console-output');
      document.getElementById('console-output').textContent = '';
    }

    loadFromLocalStorage();
  </script>
</body>
</html>
